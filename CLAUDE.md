# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Repository Purpose

This is Brian's personal dotfiles repository containing shell configurations (zsh), editor configurations (vim), terminal multiplexer configuration (tmux), and Claude Code settings. Files are meant to be symlinked from home directory to their respective locations.

## Architecture

### Configuration Files

- **vimrc**: Vim configuration using vim-plug for plugin management. Includes custom autocmds for git stripspace on save (excluding .md, .tf, .go files), airline/tmuxline integration, and language-specific settings for Go, Ruby, HTML, and Terraform.
- **zshrc**: Zsh configuration using oh-my-zsh framework with custom "brianfoshee" theme. Sets up rbenv, homebrew paths (with Apple Silicon detection), and sources API tokens from `~/.github-api-token` and `~/.anthropic-api-token`.
- **tmux.conf**: Tmux configuration with Control-Space prefix, vim-style navigation, and tmuxline snapshot integration. Allows escape sequences to rename windows via `set-window-option -g allow-rename on`.
- **claude/**: Claude Code configuration directory. Symlink this to `~/.claude` for global Claude settings.

### Key Patterns

**Vim Stripspace**: The vimrc includes a sophisticated autocmd that runs `git stripspace` on save, with exclusions for certain file types. It preserves cursor position and undo history using temporary undo files. Don't modify this pattern without testing thoroughly.

**Tmux Window Naming**: Tmux is configured to accept window name changes via escape sequences. Use `printf '\033k%s\033\\' "name"` to set window names programmatically. This is used by the global CLAUDE.md tmux window management rules.

**API Token Pattern**: Both GitHub and Anthropic API tokens are sourced from separate files (`~/.github-api-token`, `~/.anthropic-api-token`) in the home directory, not stored in this repo. These files should export the appropriate environment variables.

## Development Workflow

### Making Changes to Dotfiles

Since these files are symlinked from `~/.dotfiles` to the home directory (e.g., `~/.vimrc -> ~/.dotfiles/vimrc`), changes made to either location affect the same file. Always commit changes from the `~/.dotfiles` directory.

### Testing Configuration Changes

- **Vim**: Source changes with `:source ~/.vimrc` or restart vim
- **Zsh**: Source changes with `source ~/.zshrc` or start a new shell
- **Tmux**: Source changes with `tmux source-file ~/.tmux.conf` or use `prefix + :source-file ~/.tmux.conf`

### Vim Plugins

Plugins are managed by vim-plug. After adding a plugin to vimrc:
1. Restart vim or `:source ~/.vimrc`
2. Run `:PlugInstall` to install new plugins
3. Run `:PlugUpdate` to update existing plugins
4. Run `:PlugClean` to remove deleted plugins

### Generating Tmuxline Snapshot

The tmux status bar styling is generated by the vim tmuxline plugin and saved to `tmuxline-snapshot`. To regenerate:

```vim
:Tmuxline airline
:TmuxlineSnapshot! ~/.dotfiles/tmuxline-snapshot
```

## Critical Rules

- NEVER modify the vim stripspace autocmd without explicit approval - it's carefully designed to preserve undo history and cursor position
- NEVER commit API tokens or sensitive credentials to this repository
- NEVER change whitespace handling in vimrc without testing on multiple file types
- The global `~/.claude/CLAUDE.md` file is the source of truth for Claude Code behavior - this file supplements it with dotfiles-specific context
